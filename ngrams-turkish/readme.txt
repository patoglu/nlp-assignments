Needs Python 3.8
Code is not great, lots of duplicated lines.